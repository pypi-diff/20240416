# Comparing `tmp/stix_shifter_modules_sumologic-7.0.4-py2.py3-none-any.whl.zip` & `tmp/stix_shifter_modules_sumologic-7.0.6-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,28 +1,28 @@
-Zip file size: 31768 bytes, number of entries: 26
--rw-rw-r--  2.0 unx        0 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/__init__.py
--rw-rw-r--  2.0 unx      396 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/entry_point.py
--rw-rw-r--  2.0 unx    12545 b- defN 24-Mar-14 15:50 stix_shifter_modules/sumologic/configuration/config.json
--rw-rw-r--  2.0 unx       78 b- defN 24-Mar-14 15:50 stix_shifter_modules/sumologic/configuration/dialects.json
--rw-rw-r--  2.0 unx     2814 b- defN 24-Mar-14 15:50 stix_shifter_modules/sumologic/configuration/lang_en.json
--rw-rw-r--  2.0 unx        0 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/__init__.py
--rw-rw-r--  2.0 unx    26842 b- defN 24-Mar-14 15:50 stix_shifter_modules/sumologic/stix_translation/json_to_stix_translator.py
--rw-rw-r--  2.0 unx    12022 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/query_constructor.py
--rw-rw-r--  2.0 unx     1029 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/query_translator.py
--rw-rw-r--  2.0 unx     1394 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/json/from_stix_map.json
--rw-rw-r--  2.0 unx      250 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/json/operators.json
--rw-rw-r--  2.0 unx     2520 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_translation/json/to_stix_map.json
--rw-rw-r--  2.0 unx        0 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/__init__.py
--rw-rw-r--  2.0 unx     2307 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/api_client.py
--rw-rw-r--  2.0 unx     1269 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/delete_connector.py
--rw-rw-r--  2.0 unx     1733 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/error_mapper.py
--rw-rw-r--  2.0 unx     1191 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/ping_connector.py
--rw-rw-r--  2.0 unx     1109 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/query_connector.py
--rw-rw-r--  2.0 unx     1348 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/results_connector.py
--rw-rw-r--  2.0 unx     2459 b- defN 24-Mar-14 15:48 stix_shifter_modules/sumologic/stix_transmission/status_connector.py
--rw-rw-r--  2.0 unx    12786 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/LICENSE.md
--rw-rw-r--  2.0 unx     7212 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/METADATA
--rw-rw-r--  2.0 unx     1418 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/NOTICE
--rw-rw-r--  2.0 unx      110 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx       21 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3003 b- defN 24-Mar-14 15:50 stix_shifter_modules_sumologic-7.0.4.dist-info/RECORD
-26 files, 95856 bytes uncompressed, 26596 bytes compressed:  72.3%
+Zip file size: 31877 bytes, number of entries: 26
+-rw-rw-r--  2.0 unx        0 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/__init__.py
+-rw-rw-r--  2.0 unx      396 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/entry_point.py
+-rw-rw-r--  2.0 unx    12667 b- defN 24-Apr-16 17:19 stix_shifter_modules/sumologic/configuration/config.json
+-rw-rw-r--  2.0 unx       78 b- defN 24-Apr-16 17:19 stix_shifter_modules/sumologic/configuration/dialects.json
+-rw-rw-r--  2.0 unx     2814 b- defN 24-Apr-16 17:19 stix_shifter_modules/sumologic/configuration/lang_en.json
+-rw-rw-r--  2.0 unx        0 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/__init__.py
+-rw-rw-r--  2.0 unx    26842 b- defN 24-Apr-16 17:19 stix_shifter_modules/sumologic/stix_translation/json_to_stix_translator.py
+-rw-rw-r--  2.0 unx    12207 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/query_constructor.py
+-rw-rw-r--  2.0 unx     1029 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/query_translator.py
+-rw-rw-r--  2.0 unx     1394 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/json/from_stix_map.json
+-rw-rw-r--  2.0 unx      333 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/json/operators.json
+-rw-rw-r--  2.0 unx     2520 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_translation/json/to_stix_map.json
+-rw-rw-r--  2.0 unx        0 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/__init__.py
+-rw-rw-r--  2.0 unx     2307 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/api_client.py
+-rw-rw-r--  2.0 unx     1269 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/delete_connector.py
+-rw-rw-r--  2.0 unx     1733 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/error_mapper.py
+-rw-rw-r--  2.0 unx     1191 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/ping_connector.py
+-rw-rw-r--  2.0 unx     1109 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/query_connector.py
+-rw-rw-r--  2.0 unx     1348 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/results_connector.py
+-rw-rw-r--  2.0 unx     2459 b- defN 24-Apr-16 17:16 stix_shifter_modules/sumologic/stix_transmission/status_connector.py
+-rw-rw-r--  2.0 unx    12786 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/LICENSE.md
+-rw-rw-r--  2.0 unx     7212 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/METADATA
+-rw-rw-r--  2.0 unx     1418 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/NOTICE
+-rw-rw-r--  2.0 unx      110 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       21 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3003 b- defN 24-Apr-16 17:19 stix_shifter_modules_sumologic-7.0.6.dist-info/RECORD
+26 files, 96246 bytes uncompressed, 26705 bytes compressed:  72.3%
```

## zipnote {}

```diff
@@ -54,26 +54,26 @@
 
 Filename: stix_shifter_modules/sumologic/stix_transmission/results_connector.py
 Comment: 
 
 Filename: stix_shifter_modules/sumologic/stix_transmission/status_connector.py
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/LICENSE.md
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/LICENSE.md
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/METADATA
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/METADATA
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/NOTICE
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/NOTICE
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/WHEEL
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/WHEEL
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/top_level.txt
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/top_level.txt
 Comment: 
 
-Filename: stix_shifter_modules_sumologic-7.0.4.dist-info/RECORD
+Filename: stix_shifter_modules_sumologic-7.0.6.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## stix_shifter_modules/sumologic/configuration/config.json

### Pretty-printed

 * *Similarity: 0.9999937399839743%*

 * *Differences: {"'connection'": "{'options': {'mapping': {'default': {'operators': "*

 * *                 "{'ComparisonComparators.NotEqual': '=', 'ComparisonComparators.Like': '='}}}}}"}*

```diff
@@ -130,14 +130,16 @@
                                 ]
                             }
                         }
                     },
                     "operators": {
                         "ComparisonComparators.Equal": "=",
                         "ComparisonComparators.In": "OR",
+                        "ComparisonComparators.Like": "=",
+                        "ComparisonComparators.NotEqual": "=",
                         "ComparisonExpressionOperators.And": "AND",
                         "ComparisonExpressionOperators.Or": "OR",
                         "ObservationOperators.And": "AND",
                         "ObservationOperators.Or": "OR"
                     },
                     "to_stix_map": {
                         "_collector": [
```

## stix_shifter_modules/sumologic/stix_translation/query_constructor.py

```diff
@@ -56,15 +56,15 @@
 
     @staticmethod
     def _format_equality(value) -> str:
         return '\'{}\''.format(value)
 
     @staticmethod
     def _format_like(value) -> str:
-        value = "'%{value}%'".format(value=value)
+        value = value.replace('%', '*').replace('_', '?')
         return QueryStringPatternTranslator._escape_value(value)
 
     @staticmethod
     def _escape_value(value, comparator=None) -> str:
         if isinstance(value, str):
             return '{}'.format(value.replace('\\', '\\\\').replace('\"', '\\"').replace('(', '\\(').replace(')', '\\)'))
         else:
@@ -106,19 +106,22 @@
             else:
                 if is_reference_value:
                     parsed_reference = self._parse_reference(self, stix_field, value_type, mapped_field, value, comparator)
                     if not parsed_reference:
                         continue
                     comparison_string += parsed_reference
                 else:
-                    comparison_string += "{mapped_field} {comparator} {value}".format(mapped_field=mapped_field,
-                                                                                      comparator=comparator, value=value)
+                    format_string = "{mapped_field} {comparator} {value}"
+                    if expression.comparator == ComparisonComparators.NotEqual:
+                        format_string = self._negate_comparison(format_string)
+                    comparison_string += format_string.format(mapped_field=mapped_field,
+                                                              comparator=comparator, value=value)
 
             if mapped_fields_count > 1:
-                comparison_string += " OR "
+                comparison_string += " AND " if expression.comparator == ComparisonComparators.NotEqual else " OR "
                 mapped_fields_count -= 1
 
         return comparison_string
 
     @staticmethod
     def _is_reference_value(stix_field):
         return stix_field == 'src_ref.value' or stix_field == 'dst_ref.value'
@@ -220,30 +223,36 @@
 
     def parse_expression(self, pattern: Pattern):
         return self._parse_expression(pattern)
 
 
 def translate_pattern(pattern: Pattern, data_model_mapping, options):
     query = QueryStringPatternTranslator(pattern, data_model_mapping).translated
-    query = re.sub("START", "START ", query)
-    query = re.sub("STOP", " STOP ", query)
     query, from_time, to_time = convert_timestamp(query)
     query_dict = {"query": query.replace("'", "\""), "fromTime": from_time, "toTime": to_time}
     query_str = json.dumps(query_dict)
     return [query_str]
 
 
+def to_datetime(value):
+    if '.' in value:
+        time_pattern = '%Y-%m-%dT%H:%M:%S.%fZ'
+    else:
+        time_pattern = '%Y-%m-%dT%H:%M:%SZ'
+    return datetime.datetime.strptime(value, time_pattern).replace(tzinfo=datetime.timezone.utc)
+
+
+def to_epoch_ms(value):
+    return int(value.timestamp() * 1000)
+
+
 def convert_timestamp(query):
     if ('START' and 'STOP') in query:
-        x = re.search('(.*)(?= START )(.*)(?<=STOP )(.*)', query)
-        query = x.group(1)
-        from_time = x.group(2).replace(' START ', "").replace(" STOP ", "")
-        to_time = x.group(3)
-        from_time = datetime.datetime.strptime(from_time, "t'%Y-%m-%dT%H:%M:%S.%fZ'").strftime("%Y%m%dT%H%M%S")
-        to_time = datetime.datetime.strptime(to_time, "t'%Y-%m-%dT%H:%M:%S.%fZ'").strftime("%Y%m%dT%H%M%S")
+        x = re.search(r"(.*)\s*START\s*t'(.*)'\s*STOP\s*t'(.*)'", query)
+        query = x.group(1).strip(' ')
+        from_time = to_datetime(x.group(2))
+        to_time = to_datetime(x.group(3))
     else:
         to_time = datetime.datetime.utcnow()
         from_time = (to_time - datetime.timedelta(minutes=15))
-        to_time = to_time.strftime("%Y%m%dT%H%M%S")
-        from_time = from_time.strftime("%Y%m%dT%H%M%S")
 
-    return query, from_time, to_time
+    return query, to_epoch_ms(from_time), to_epoch_ms(to_time)
```

## stix_shifter_modules/sumologic/stix_translation/json/operators.json

### Pretty-printed

 * *Similarity: 0.75%*

 * *Differences: {"'ComparisonComparators.Like'": "'='", "'ComparisonComparators.NotEqual'": "'='"}*

```diff
@@ -1,8 +1,10 @@
 {
     "ComparisonComparators.Equal": "=",
     "ComparisonComparators.In": "OR",
+    "ComparisonComparators.Like": "=",
+    "ComparisonComparators.NotEqual": "=",
     "ComparisonExpressionOperators.And": "AND",
     "ComparisonExpressionOperators.Or": "OR",
     "ObservationOperators.And": "AND",
     "ObservationOperators.Or": "OR"
 }
```

## Comparing `stix_shifter_modules_sumologic-7.0.4.dist-info/LICENSE.md` & `stix_shifter_modules_sumologic-7.0.6.dist-info/LICENSE.md`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_sumologic-7.0.4.dist-info/METADATA` & `stix_shifter_modules_sumologic-7.0.6.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: stix_shifter_modules_sumologic
-Version: 7.0.4
+Version: 7.0.6
 Summary: Tools and interface to translate STIX formatted results and queries to different data source formats and to set up appropriate connection strings for invoking and triggering actions in openwhisk
 Home-page: https://github.com/opencybersecurityalliance/stix-shifter
 Author: ibm
 Author-email: 
 Project-URL: Source, https://github.com/opencybersecurityalliance/stix-shifter
 Keywords: datasource stix translate transform transmit
 Classifier: License :: OSI Approved :: Apache Software License
```

## Comparing `stix_shifter_modules_sumologic-7.0.4.dist-info/NOTICE` & `stix_shifter_modules_sumologic-7.0.6.dist-info/NOTICE`

 * *Files identical despite different names*

## Comparing `stix_shifter_modules_sumologic-7.0.4.dist-info/RECORD` & `stix_shifter_modules_sumologic-7.0.6.dist-info/RECORD`

 * *Files 19% similar despite different names*

```diff
@@ -1,26 +1,26 @@
 stix_shifter_modules/sumologic/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/sumologic/entry_point.py,sha256=ajfRGukmgtpgk8uOy1cI8sfEGjNdcoiJo3jm-uL4FJA,396
-stix_shifter_modules/sumologic/configuration/config.json,sha256=0R6CwfH_NO8jtEL33kdTKwYq-odvI4SBGP9fPTG5xKE,12545
+stix_shifter_modules/sumologic/configuration/config.json,sha256=Ktr0m3twkfm0VArWNo0d9g1WZWFDpFpiOahcQKhYhJ8,12667
 stix_shifter_modules/sumologic/configuration/dialects.json,sha256=tewYuoIE-WBBxsLTlOstMkMSUs6sFlEyW1dveC61xwk,78
 stix_shifter_modules/sumologic/configuration/lang_en.json,sha256=iu9DBA49SpNJhQZ8xMJT__4MAtLin1_ebxBMrIsnu7o,2814
 stix_shifter_modules/sumologic/stix_translation/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/sumologic/stix_translation/json_to_stix_translator.py,sha256=JQYc8AoRarJU4PlETIBsx_1f2J_axc1YBjiAaDUCokw,26842
-stix_shifter_modules/sumologic/stix_translation/query_constructor.py,sha256=xX1wN3fUuL1ZEPbMvlmikhHDLmyNyAKtt34tztkQIsw,12022
+stix_shifter_modules/sumologic/stix_translation/query_constructor.py,sha256=5EvMHZ90bjUKiaIfkdy7VvCnY_1rYiHTZri1N81e560,12207
 stix_shifter_modules/sumologic/stix_translation/query_translator.py,sha256=1IsBlz_YYM9s0myfyed9Wy0fqkV82k77UXd_fTEE38w,1029
 stix_shifter_modules/sumologic/stix_translation/json/from_stix_map.json,sha256=ZJPFpvPwt4OXPExjaPEU_lK8folmGorHRIE_V5CLH5E,1394
-stix_shifter_modules/sumologic/stix_translation/json/operators.json,sha256=MPWN1hHSBzMbQt3iO6Xc_wQq4nHwvtET-RtEsA7vKOo,250
+stix_shifter_modules/sumologic/stix_translation/json/operators.json,sha256=_pXAwgFrEW3RZ7lEDV2FYWmJ0K23VR0zCKbFLIg_HXM,333
 stix_shifter_modules/sumologic/stix_translation/json/to_stix_map.json,sha256=zn53trHId8GyVqoA4c1amS36PauhYGV9nxallmDccnI,2520
 stix_shifter_modules/sumologic/stix_transmission/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 stix_shifter_modules/sumologic/stix_transmission/api_client.py,sha256=1jUt9vwxFblZTclPoEROKS453kTA78NOOs5WGH-MyRw,2307
 stix_shifter_modules/sumologic/stix_transmission/delete_connector.py,sha256=xKCFhOuQwPutgHjp-rItSKjo0f344gKCRMbSY8solRc,1269
 stix_shifter_modules/sumologic/stix_transmission/error_mapper.py,sha256=h57nrAGjGwFoyDpwIGYBBeUHcF-Cxpho86bf5ejhiL0,1733
 stix_shifter_modules/sumologic/stix_transmission/ping_connector.py,sha256=3ml8IbsD-uNID6OGu6COMWkVzhdhu8tjXQp6ch4mMfc,1191
 stix_shifter_modules/sumologic/stix_transmission/query_connector.py,sha256=W0YXffYolT4nd4qqhj7Aw9fkdVFK08hMnpHXLdMcjAQ,1109
 stix_shifter_modules/sumologic/stix_transmission/results_connector.py,sha256=a4rCFsB4Q6LDjhVeZQuKB-NuHjFK7ZmwNlr_t_gKyLM,1348
 stix_shifter_modules/sumologic/stix_transmission/status_connector.py,sha256=uxWVvDZmtMBzh1ym_qjFuKcCHKdeoh6px6KtTtdiNk8,2459
-stix_shifter_modules_sumologic-7.0.4.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
-stix_shifter_modules_sumologic-7.0.4.dist-info/METADATA,sha256=12ZT0cjAY813zamAGtwDu7ohYqll14cOY9iK3Ad6YTA,7212
-stix_shifter_modules_sumologic-7.0.4.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
-stix_shifter_modules_sumologic-7.0.4.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
-stix_shifter_modules_sumologic-7.0.4.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
-stix_shifter_modules_sumologic-7.0.4.dist-info/RECORD,,
+stix_shifter_modules_sumologic-7.0.6.dist-info/LICENSE.md,sha256=ssGEKMVW69oFTBblVhD1YPolqCOyOCJi4wRDRI7xCnU,12786
+stix_shifter_modules_sumologic-7.0.6.dist-info/METADATA,sha256=9yrJz-whTfbyQgw0bCf8QotDBoF7UkMwO-elFhlNO-I,7212
+stix_shifter_modules_sumologic-7.0.6.dist-info/NOTICE,sha256=wx-gWE9vSnLJ7YQkrGlMp9VNXOXG57TTxDDRd9CEdYg,1418
+stix_shifter_modules_sumologic-7.0.6.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
+stix_shifter_modules_sumologic-7.0.6.dist-info/top_level.txt,sha256=NX-VgUOr8fI-lMXHt3gtjfsEn1UPaGAVszt6Z_CTp2s,21
+stix_shifter_modules_sumologic-7.0.6.dist-info/RECORD,,
```

