# Comparing `tmp/asktable-0.13.7-py3-none-any.whl.zip` & `tmp/asktable-0.13.9-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,34 +1,34 @@
-Zip file size: 29493 bytes, number of entries: 32
+Zip file size: 29610 bytes, number of entries: 32
 -rw-r--r--  2.0 unx       86 b- defN 24-Apr-02 15:29 asktable/__init__.py
 -rw-r--r--  2.0 unx     2180 b- defN 24-Apr-01 06:16 asktable/api.py
 -rw-r--r--  2.0 unx     1667 b- defN 24-Apr-01 06:16 asktable/cli.py
 -rw-r--r--  2.0 unx      887 b- defN 24-Apr-05 04:16 asktable/client.py
 -rw-r--r--  2.0 unx       41 b- defN 24-Apr-01 06:16 asktable/exceptions.py
 -rw-r--r--  2.0 unx      875 b- defN 24-Apr-01 06:44 asktable/log.py
 -rw-r--r--  2.0 unx     1492 b- defN 24-Apr-01 06:16 asktable/upload.py
--rw-r--r--  2.0 unx      152 b- defN 24-Apr-01 06:16 asktable/models/__init__.py
--rw-r--r--  2.0 unx     2588 b- defN 24-Apr-01 06:16 asktable/models/base.py
--rw-r--r--  2.0 unx     2769 b- defN 24-Apr-01 06:16 asktable/models/chat.py
--rw-r--r--  2.0 unx    10180 b- defN 24-Apr-06 02:14 asktable/models/datasource.py
--rw-r--r--  2.0 unx     1264 b- defN 24-Apr-01 06:16 asktable/models/message.py
--rw-r--r--  2.0 unx      878 b- defN 24-Apr-01 06:16 asktable/models/run.py
+-rw-r--r--  2.0 unx      158 b- defN 24-Apr-06 09:09 asktable/models/__init__.py
+-rw-r--r--  2.0 unx     2588 b- defN 24-Apr-01 06:16 asktable/models/client_base.py
+-rw-r--r--  2.0 unx     2786 b- defN 24-Apr-06 09:09 asktable/models/client_chat.py
+-rw-r--r--  2.0 unx    10445 b- defN 24-Apr-06 09:09 asktable/models/client_ds.py
+-rw-r--r--  2.0 unx     1271 b- defN 24-Apr-06 09:09 asktable/models/client_msg.py
+-rw-r--r--  2.0 unx      885 b- defN 24-Apr-06 09:09 asktable/models/client_run.py
 -rw-r--r--  2.0 unx        0 b- defN 23-Dec-08 14:27 atcommon/__init__.py
 -rw-r--r--  2.0 unx     3296 b- defN 24-Apr-04 03:57 atcommon/tools.py
--rw-r--r--  2.0 unx       16 b- defN 24-Apr-06 07:15 atcommon/version.py
+-rw-r--r--  2.0 unx       16 b- defN 24-Apr-08 11:30 atcommon/version.py
 -rw-r--r--  2.0 unx        0 b- defN 24-Jan-31 13:33 atcommon/exceptions/__init__.py
 -rw-r--r--  2.0 unx     1282 b- defN 24-Apr-02 15:21 atcommon/exceptions/client.py
 -rw-r--r--  2.0 unx       95 b- defN 24-Apr-01 06:16 atcommon/exceptions/server.py
 -rw-r--r--  2.0 unx     2089 b- defN 24-Apr-02 14:43 atcommon/exceptions/server_base.py
 -rw-r--r--  2.0 unx      589 b- defN 24-Apr-01 06:16 atcommon/exceptions/server_plugins.py
 -rw-r--r--  2.0 unx      466 b- defN 24-Apr-01 06:16 atcommon/models/__init__.py
 -rw-r--r--  2.0 unx      731 b- defN 24-Jan-20 03:26 atcommon/models/base.py
 -rw-r--r--  2.0 unx     2344 b- defN 24-Apr-01 06:16 atcommon/models/bi.py
 -rw-r--r--  2.0 unx     1069 b- defN 24-Apr-01 06:16 atcommon/models/chat.py
 -rw-r--r--  2.0 unx     1424 b- defN 24-Apr-03 14:46 atcommon/models/datasource.py
 -rw-r--r--  2.0 unx    27794 b- defN 24-Apr-06 01:31 atcommon/models/meta.py
--rw-r--r--  2.0 unx     9875 b- defN 24-Apr-06 07:56 asktable-0.13.7.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Apr-06 07:56 asktable-0.13.7.dist-info/WHEEL
--rw-r--r--  2.0 unx       47 b- defN 24-Apr-06 07:56 asktable-0.13.7.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       18 b- defN 24-Apr-06 07:56 asktable-0.13.7.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     2558 b- defN 24-Apr-06 07:56 asktable-0.13.7.dist-info/RECORD
-32 files, 78844 bytes uncompressed, 25413 bytes compressed:  67.8%
+-rw-r--r--  2.0 unx     9875 b- defN 24-Apr-08 11:30 asktable-0.13.9.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-08 11:30 asktable-0.13.9.dist-info/WHEEL
+-rw-r--r--  2.0 unx       47 b- defN 24-Apr-08 11:30 asktable-0.13.9.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       18 b- defN 24-Apr-08 11:30 asktable-0.13.9.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     2581 b- defN 24-Apr-08 11:30 asktable-0.13.9.dist-info/RECORD
+32 files, 79169 bytes uncompressed, 25484 bytes compressed:  67.8%
```

## zipnote {}

```diff
@@ -18,27 +18,27 @@
 
 Filename: asktable/upload.py
 Comment: 
 
 Filename: asktable/models/__init__.py
 Comment: 
 
-Filename: asktable/models/base.py
+Filename: asktable/models/client_base.py
 Comment: 
 
-Filename: asktable/models/chat.py
+Filename: asktable/models/client_chat.py
 Comment: 
 
-Filename: asktable/models/datasource.py
+Filename: asktable/models/client_ds.py
 Comment: 
 
-Filename: asktable/models/message.py
+Filename: asktable/models/client_msg.py
 Comment: 
 
-Filename: asktable/models/run.py
+Filename: asktable/models/client_run.py
 Comment: 
 
 Filename: atcommon/__init__.py
 Comment: 
 
 Filename: atcommon/tools.py
 Comment: 
@@ -75,23 +75,23 @@
 
 Filename: atcommon/models/datasource.py
 Comment: 
 
 Filename: atcommon/models/meta.py
 Comment: 
 
-Filename: asktable-0.13.7.dist-info/METADATA
+Filename: asktable-0.13.9.dist-info/METADATA
 Comment: 
 
-Filename: asktable-0.13.7.dist-info/WHEEL
+Filename: asktable-0.13.9.dist-info/WHEEL
 Comment: 
 
-Filename: asktable-0.13.7.dist-info/entry_points.txt
+Filename: asktable-0.13.9.dist-info/entry_points.txt
 Comment: 
 
-Filename: asktable-0.13.7.dist-info/top_level.txt
+Filename: asktable-0.13.9.dist-info/top_level.txt
 Comment: 
 
-Filename: asktable-0.13.7.dist-info/RECORD
+Filename: asktable-0.13.9.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## asktable/models/__init__.py

```diff
@@ -1,7 +1,7 @@
-from asktable.models.datasource import DataResourceList
-from asktable.models.chat import ChatList
+from asktable.models.client_ds import DataResourceList
+from asktable.models.client_chat import ChatList
 
 __ALL__ = [
     "DataResourceList",
     "ChatList"
 ]
```

## atcommon/version.py

```diff
@@ -1 +1 @@
-VERSION="0.13.7"
+VERSION="0.13.9"
```

## Comparing `asktable/models/base.py` & `asktable/models/client_base.py`

 * *Files identical despite different names*

## Comparing `asktable/models/chat.py` & `asktable/models/client_chat.py`

 * *Files 6% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 from datetime import datetime
 from atcommon.models import ChatCore
 from atcommon.tools import format_time_ago
-from asktable.models.base import convert_to_object, BaseResourceList
-from asktable.models.run import RunList
-from asktable.models.message import MessageList, MessageClientModel
+from asktable.models.client_base import convert_to_object, BaseResourceList
+from asktable.models.client_run import RunList
+from asktable.models.client_msg import MessageList, MessageClientModel
 
 
 class ChatClientModel(ChatCore):
 
 
     def delete(self):
         return self.api.send(endpoint=f"/chats/{self.id}", method="DELETE")
```

## Comparing `asktable/models/datasource.py` & `asktable/models/client_ds.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 import os
 import time
 from asktable.log import log
 from atcommon.models import DataSourceCore, MetaData
-from asktable.models.chat import ChatList
-from asktable.models.base import convert_to_object, BaseResourceList
+from asktable.models.client_chat import ChatList
+from asktable.models.client_base import convert_to_object, BaseResourceList
 from atcommon.exceptions.client import (
     DataSourceNotFound,
     UnsupportedFileType,
     DataSourceMetaProcessError,
     DataSourceMetaProcessTimeout
 )
 from asktable.upload import upload_to_oss
@@ -29,15 +29,15 @@
         self.api.send(endpoint=f"/datasources/{self.datasource_id}/meta", method="DELETE")
         return True
 
     def update(self):
         self.api.send(endpoint=f"/datasources/{self.datasource_id}/meta", method="POST")
         return True
 
-    def update_wait_success(self, timeout=600):
+    def update_until_success(self, timeout=600):
         """
         同步元数据并轮询其状态，直到超时、成功或失败。
 
         参数:
             timeout (int): 超时时间，单位为秒。默认值为 600 秒。
 
         返回:
@@ -45,44 +45,47 @@
 
         异常:
             DataSourceMetaProcessError: 如果元数据更新失败。
             DataSourceMetaProcessTimeout: 如果元数据更新超时。
         """
         # 发起同步请求
         self.update()
+        return self.wait_until_update_success(timeout)
 
+    def wait_until_update_success(self, timeout=600):
         start_time = time.time()
 
         # 初始化斐波那契数列间隔
         fib_a, fib_b = 1, 1
 
         while True:
             # 获取数据源的最新状态
             status = self.status
 
             if status == 'success':
                 log.info(f"Data Source {self.datasource_id} Meta 更新成功。")
                 return self.get()
             elif status == 'failed':
                 log.error(f"Data Source {self.datasource_id} Meta 更新失败。")
-                raise DataSourceMetaProcessError(f"DataSource Meta update failed: {self.datasource_id}")
+                return
+                # raise DataSourceMetaProcessError(f"DataSource Meta update failed: {self.datasource_id}")
 
             if time.time() - start_time > timeout:
                 log.error(f"Data Source {self.datasource_id} Meta 更新超时。")
-                raise DataSourceMetaProcessTimeout(
-                    f"DataSource Meta update timed out after {timeout} seconds for {self.datasource_id}")
+                return
+                # raise DataSourceMetaProcessTimeout(
+                #     f"DataSource Meta update timed out after {timeout} seconds for {self.datasource_id}")
 
             # 等待斐波那契数列定义的时间，或者最多10秒
             sleep_time = min(fib_b, 10)
             log.info(f"Data Source {self.datasource_id}：等待 {sleep_time} 秒后重新检查。当前状态: {status}")
             time.sleep(sleep_time)
 
             # 更新斐波那契数列的值
-            if fib_b < 10:
-                fib_a, fib_b = fib_b, fib_a + fib_b
+            fib_a, fib_b = fib_b, fib_a + fib_b
 
 
 class DataSourceClientModel(DataSourceCore):
 
     def __init__(self, *args, **kwargs):
         super().__init__(*args, **kwargs)
         self.temp_chat = None  # 初始化时没有chat实例
@@ -192,46 +195,48 @@
         data = {
             "type": type, "name": name,
             "access_config": access_config
         }
         return self.api.send(endpoint=self.endpoint, method="POST",
                              data=data)
 
-    def register_wait_success(self, type, access_config, name=None, timeout=180):
+    def register_until_success(self, type, access_config, name=None, timeout=600):
         # 注册数据源并获取其ID
         ds = self.register(type, access_config, name)
+        return self.wait_until_register_success(ds, timeout)
+
+    def wait_until_register_success(self, datasource, timeout=600):
         start_time = time.time()
 
         # 初始化斐波那契数列间隔
         fib_a, fib_b = 1, 1
 
         while True:
             # 获取数据源的最新状态
-            ds_refreshed = self.get(id=ds.id)
+            ds_refreshed = self.get(id=datasource.id)
 
             if ds_refreshed.meta_status == 'success':
-                log.info(f"Data Source {ds.id}  AI Process Success.")
+                log.info(f"Data Source {datasource.id}  AI Process Success.")
                 return ds_refreshed
             elif ds_refreshed.meta_status == 'failed':
-                log.error(f"Data Source {ds.id}  AI Process Failed.")
+                log.error(f"Data Source {datasource.id}  AI Process Failed.")
                 raise DataSourceMetaProcessError(f"DataSource AI Process failed: {ds.id}")
 
             if time.time() - start_time > timeout:
-                log.error(f"Data Source {ds.id}  AI分析超时。")
+                log.error(f"Data Source {datasource.id}  AI分析超时。")
                 raise DataSourceMetaProcessTimeout(
                     f"DataSource AI Process timed out after {timeout} seconds for {ds.id}")
 
             # 等待斐波那契数列定义的时间，或者最多10秒
             sleep_time = min(fib_b, 10)
-            log.info(f"Data Source {ds.id}: Wait for {sleep_time} seconds and check again. Current status: {ds_refreshed.meta_status}")
+            log.info(f"Data Source {datasource.id}: Wait for {sleep_time} seconds and check again. "
+                     f"Current status: {ds_refreshed.meta_status}")
             time.sleep(sleep_time)
 
-            # 更新斐波那契数列的值
-            if fib_b < 10:
-                fib_a, fib_b = fib_b, fib_a + fib_b
+            fib_a, fib_b = fib_b, fib_a + fib_b
 
     def upload_file_to_oss(self, local_file_path):
         oss_info = self.create_upload_params()['oss']
         file_name = os.path.basename(local_file_path)
         oss_file_uri = f"{oss_info['oss_uri_prefix']}{file_name}"
         url = upload_to_oss(oss_info, local_file_path, oss_file_uri)
         return url
```

## Comparing `asktable/models/message.py` & `asktable/models/client_msg.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 
 from atcommon.models import MessageCore, BIAnswer
 from atcommon.tools import format_time_ago
-from asktable.models.base import convert_to_object, BaseResourceList
+from asktable.models.client_base import convert_to_object, BaseResourceList
 
 
 class MessageClientModel(MessageCore):
 
     @property
     def answer(self):
         if self.role == 'ai':
```

## Comparing `asktable/models/run.py` & `asktable/models/client_run.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 from atcommon.models import RunCore
-from asktable.models.base import convert_to_object, BaseResourceList
+from asktable.models.client_base import convert_to_object, BaseResourceList
 
 
 class RunClientModel(RunCore):
 
     def cancel(self):
         return self.api.send(
             endpoint=f"/chats/{self.chat_id}/runs/{self.id}",
```

## Comparing `asktable-0.13.7.dist-info/METADATA` & `asktable-0.13.9.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: asktable
-Version: 0.13.7
+Version: 0.13.9
 Summary: AskTable SDK
 Home-page: https://asktable.com/
 Author: lele
 Description-Content-Type: text/markdown
 Requires-Dist: requests
 Requires-Dist: tabulate
 Requires-Dist: pybase62
```

## Comparing `asktable-0.13.7.dist-info/RECORD` & `asktable-0.13.9.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,32 +1,32 @@
 asktable/__init__.py,sha256=12mHQ4Yrr7_vY7ilhc6_tdOtuclBWPWj88YFIiTTU6I,86
 asktable/api.py,sha256=e5XbDpNv3V0OVdpUin6xhkA1xW0u-Jik5wFlS_2ZkiY,2180
 asktable/cli.py,sha256=QDzk5ixcWzD0fT345a6jW7D8JXp9ps9xRLvXT4Uh-Kc,1667
 asktable/client.py,sha256=D50bWrMySDdJdsLs-AxD1oHCeEpRn_4R2_x_XHaMWS8,887
 asktable/exceptions.py,sha256=HUys_aPowtoLqjO4XhANXBQCUUpty1zLxV4fWPqBkLc,41
 asktable/log.py,sha256=CIRsQtXMB24sD5fFsUn2hxlEVJB33Ej8TIQKyET2pQ8,875
 asktable/upload.py,sha256=ZctBvZtKnBZWucRXzvdp25zBNGz3eQ6PAfdhzLzfMUU,1492
-asktable/models/__init__.py,sha256=LDrDHxIjYwQN-fLW4BKMkuogEUcDfLxMYtlEkq0Xzfk,152
-asktable/models/base.py,sha256=vDe19yuK6SJglgRlz8Gq9qKg_x1Cxs2tK82VKeJ3UCI,2588
-asktable/models/chat.py,sha256=Z-2p_crBI5HwljcIxtRNV46_FfsVmNc5oRrwq3dNigE,2769
-asktable/models/datasource.py,sha256=S4Js9u9iV3PlfWTaYyTIxPrFJYgrpY5c3cOPFimhN5A,10180
-asktable/models/message.py,sha256=4bIt5VTBXvH5iQYb5_LoOIIbbNEkjmUsLfkjx4Il7-M,1264
-asktable/models/run.py,sha256=xf4oNReawEmQk0rmYn-uWPu_zkZD7ws1-77bOfUWYTw,878
+asktable/models/__init__.py,sha256=WMzWjKYe9ls4w_MlwfyIrOh4z7c5I2ITqMmZVWatlYg,158
+asktable/models/client_base.py,sha256=vDe19yuK6SJglgRlz8Gq9qKg_x1Cxs2tK82VKeJ3UCI,2588
+asktable/models/client_chat.py,sha256=JmNMpp0gqgH2x3MXX8rnxP3CLubXOuVSkiG1Qs9yyXk,2786
+asktable/models/client_ds.py,sha256=Mrfdcy95-nusl4lovfc4L-LeS909kZGQt7dX65lrcS8,10445
+asktable/models/client_msg.py,sha256=kTiqXcJzIKVFTlKwcFaUp4jqUqwwVGHkW4_-qd_UBvs,1271
+asktable/models/client_run.py,sha256=YEu-lhVUPamwN9yLJLLldZXTBppIOMIMZ6wOmoxPsc4,885
 atcommon/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 atcommon/tools.py,sha256=TWlukRR8iaDY0FW4zM1hXO-2xM9NPcDB9PA4eYHipDI,3296
-atcommon/version.py,sha256=GceneUTRRAdKaqJxWYOIA20h2wpMEccJSg897QOFntA,16
+atcommon/version.py,sha256=gnre4bmCw4_1YEmgmLYrwObbp7vhPdmr0cRXQ1Y9-AU,16
 atcommon/exceptions/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 atcommon/exceptions/client.py,sha256=qHJfByYYiVOwdAs_L-R655tBmep6Kpg1ixvktBNQNA0,1282
 atcommon/exceptions/server.py,sha256=BSlYmdfDasoAq6oK9fyGhws3EBPII_hkHpx_JQmMdAY,95
 atcommon/exceptions/server_base.py,sha256=-X7xH1cmypIwl007CvuN2MIGqCv89sYb5jVi7s-Uzkc,2089
 atcommon/exceptions/server_plugins.py,sha256=MqQgXsGHUn0JB3EAos1vlf8SLjUMNGXAY7lcBKSA_8c,589
 atcommon/models/__init__.py,sha256=QDsebmmUAHCKrMs789lDMt9HU9DR0kH-TGnE1CtW9kU,466
 atcommon/models/base.py,sha256=UVM9dKL22-k4k44H6DYQeNIe35vJ1Vg0ppGDZiVDiIU,731
 atcommon/models/bi.py,sha256=77HEtXOEj2tJwXe34s5Shsu4LWDihxAols8Rcz5cOFU,2344
 atcommon/models/chat.py,sha256=Si_eo8H8h_NtIOc76qhXoYcHp_tPMavud2sEnUXEejo,1069
 atcommon/models/datasource.py,sha256=Qv-IIC9hDGXrWe5s__4U_f51QNDi9BCMJrf42cUJ5Tg,1424
 atcommon/models/meta.py,sha256=OZesut61aJuotvzhj6k92tvcvaOut6E5v5rNNpFzVGo,27794
-asktable-0.13.7.dist-info/METADATA,sha256=duqv4vYPwNkJ9NOVKVJAbNez9_91riSmdIfGAdyIatA,9875
-asktable-0.13.7.dist-info/WHEEL,sha256=Xo9-1PvkuimrydujYJAjF7pCkriuXBpUPEjma1nZyJ0,92
-asktable-0.13.7.dist-info/entry_points.txt,sha256=OS7zXFo5f2wYttNLFf6EScGBaN_2XtYbV_Fl_C3RhY8,47
-asktable-0.13.7.dist-info/top_level.txt,sha256=j_dz8lioIJZMGAy7UUdXv0ytGGhh8HFsGhSXaULxT4M,18
-asktable-0.13.7.dist-info/RECORD,,
+asktable-0.13.9.dist-info/METADATA,sha256=_J_bcBMgfeQkRiCnopgL9z58G5gkLvBHId2Hr1gBSyU,9875
+asktable-0.13.9.dist-info/WHEEL,sha256=Xo9-1PvkuimrydujYJAjF7pCkriuXBpUPEjma1nZyJ0,92
+asktable-0.13.9.dist-info/entry_points.txt,sha256=OS7zXFo5f2wYttNLFf6EScGBaN_2XtYbV_Fl_C3RhY8,47
+asktable-0.13.9.dist-info/top_level.txt,sha256=j_dz8lioIJZMGAy7UUdXv0ytGGhh8HFsGhSXaULxT4M,18
+asktable-0.13.9.dist-info/RECORD,,
```

